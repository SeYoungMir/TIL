# 8. 크롤러 유지보수와 운용
## 1. 정기적인 실행과 주기적인 실행
### 3. 특정 디렉터리를 기준으로 실행할 때
4. 디스크 압박 막기
   - 별도의 설정을 하지 않으면 메일의 내용이 /var/mail에 계속 쌓임. 그래서 출력이 너무 많으면 디스크에 압박을 줄 수 있음. 불필요할 때는 MAILTO에 빈 문자열을 설정해서 출력 결과가 로컬 메일로 전송되지 않게 설정하기 바람.
   - ```crontab
     MAILTO=""
     * * * * * echo 'test' && date
     ```
   - 다만 위와 같이 설정하면 출력 결과가 어디에도 저장되지 않음. 프로그램 내부에서 로그를 저장하게 하면 좋겠지만, '동작 확인을 위해서 출력 결과를 그냥 곧바로 파일로 리다이렉트'하고 싶을 수도 있음.
5. 출력 결과를 파일로 리다이렉트하기
   - 예를 들어 출력 결과를 파일로 리다이렉트 하려면 다음과 같이 설정.
   -  ```crontab
     MAILTO=""
     * * * * * echo 'test' && date 2>&1 >> ~/command.log
     ```
   - 위 명령어에서 2>&1은 표준 오류 출력(파일 디스크립터 번호 2) 과 표준 출력(파일 디스크립터 번호 1)을 모두 같은 곳에 출력한다는 의미. 출력 리다이렉트 경로는 홈 디렉터리의 command.log 파일.
   - command.log의 내용을 확인
   - echo 'test'에서 출력되어야 하는 'test'가 출력되지 않은 것을 볼 수 있음. 이는 출력 결과를 리다이렉트 하는 것이 뒤에 있는 date 명령어 뿐이기 때문.
   - 두 명령어를 모두 출력하고 싶다면 다음과 같이 설정
   - ```crontab
     MAILTO=""
     * * * * * echo 'test' 2>&1 >> ~/command.log && date 2>&1 >> ~/command.log 
     ```
6. 매일 파일 이름 변경.
   - 매일 파일 이름을 변경하고 싶다면 다음과 같이 명령어 사용.
   - ```crontab
     MAILTO=""
     * * * * * echo 'test' 2>&1 >> ~/command_$(date + "\%Y-\%m-\%d\%H:\%M:\%S").log 
     ```
   - *장기 운용할 때
     - 이러한 설정도 장기간 운용하다보면 디스크 압박 가능. 따라서 logrotate를 설정해서 로그 파일을 교환하거나, 정기적으로 로그를 다른 디스크로 이동하게 만들어서 로그가 너무 많이 늘어나는 것을 막는 것을 추천
   - $() 기법으로 date 명령어의 실행 결과 전개. 날짜 형식의 지정은 + 기호로 함. crontab 내부에서 % 기호는 명령어의 종료 지점으로 해석되므로 백슬래시를 사용, 이를 이스케이프 해야함. 추가로 date 명령어의 서식은 시스템에 따라 다를 수 있으며 위의 코드는 macOS(BSD 계열의 유닉스)의 예임.