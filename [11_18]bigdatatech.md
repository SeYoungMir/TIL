# 3. 빅데이터 수집
## 2. 빅데이터 수집에 활용할 기술
### 4. 카프카
2. 카프카 아키텍처
   - 클러스터 방식에 따라 세 가지 아키텍처 구성이 가능, 주키퍼를 반드시 이용
     1.  1대의 카프카 서버만 설치, 1개의 Broker만 구성. 대량의 발행/소비 요건 없고 업무 도메인이 단순함
         - 주키퍼
           - Provider 1 - N
           - Kafka Node
             - KafKa Broker
               - Topic 1
               - Topic 2
           - Consumer 1 - N
     2.  1대의 카프카 서버에 2개의 Broker를 구성. 물리적인 카프카 서버가 1대, 대량의 발행/소비 요건에는 사용하기 어렵고, 업무 도메인이 복잡해 메시지 처리를 분리 관리해야 할 때 이용
         - 주키퍼
               - Provider 1 - N
               - Kafka Node
                 - KafKa Broker1
                   - Topic 1-1
                   - Topic 1-2
                 - KafKa Broker2
                   - Topic 2-1
                   - Topic 2-2
               - Consumer 1 - N 
     3.  2대 이상의 카프카 서버로 멀티 브로커 구성, 대규모 발행/소비 데이터 처리에 적합, 물리적으로 나눠진 브로커 간의 데이터 복제가 가능해 안정성 높음, 또 업무 도메인별 메시지 그룹을 분류할 수 있어 복잡한 메시지 송/수신에 활용 시 적합
         - 주키퍼
               - Provider 1 - N
               - Kafka Node 1
                 - KafKa Broker1
                   - Topic 1-1
                   - Topic 1-2
                - Kafka Node 2
                 - KafKa Broker2
                   - Topic 2-1
                   - Topic 2-2
                 - KafKa Broker2
                   - Topic 3-1
                   - Topic 3-2
               - Consumer 1 - N
3. 카프카 활용 방안
   - 카프카의 역할은 단순
   - 플럼이 실시간 데이터를 수집해 카프카 토픽에 전송, 카프카는 전송받은 데이터를 토픽에 임시로 저장하고 있다가 컨슈머 프로그램이 작동해 토픽에서 데이터를 가져감
    - 플럼 (대규모 실시간 로그)
      - 비동기(Speed Data)
    - 카프카
      - Buffering
      - Transaction1-N
    - 실시간 처리/분석 알림 활용
    - 실시간 처리/분석 적재 활용
   - 카프카의 활용 목적은 플럼이 아주 빠르게 발생하는 데이터를 실시간으로 수집하게 되면 이를 최종 목적지에 전달하기 전 중간에서 안정적인 버퍼링 처리 필요하기 때문
   - 데이터 수집이 빠르면 플럼에서 부담을 가짐, 카프카와 같은 분산 환경의 대규모 중간 저장소가 완충 역할을 함, 안정적 수집 아키텍처 구성 가능
   - 플럼이 수집한 데이터를 카프카를 거치지 않고 곧바로 타깃 저장소 HBase에 전송하면, Hbase에 장애 발생 시 플럼의 Channel에 전송하지 못한 데이터가 빠르게 쌓여 플럼 장애로 이어짐
     - 결국 실시간 데이터 수집 불가, 데이터 유실 발생
   - 카프카를 대규모 분산 환경으로 구성 시 HBase 장애가 발생 시 카프카에서 데이터 저장, HBase가 복구되면 곧바로 재처리 가능, 플럼이 수집한 데이터를 카프카의 토픽에 비동기 전송으로 수집 속도 빨라짐.