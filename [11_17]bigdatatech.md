# 3. 빅데이터 수집
## 2. 빅데이터 수집에 활용할 기술
### 3. 플럼
2. 플럼 아키텍처
- 플럼 메커니즘은 Source, Channel, Sink 만을 활용하는 매우 단순하면서 직관적인 구조를 가짐.
- 플럼의 Source에서 데이터를 로드하고, Channel에서 데이터를 임시 저장해 놓았다가 Sink를 통해 목적지에 데이터를 최종 적재함.
- 이러한 메커니즘을 기반으로 플럼은 수집 요건에 따라 다양한 분산 아키텍처 구조로 확대 가능, 대표적인 4가지 구성 방안 존재
  1. 가장 단순한 플럼 에이전트 구성
     - 플럼 에이전트
       - Source - Channel - Sink
  2. 원천 데이터를 수집할 때 Interceptor를 추가해 데이터를 가공, 데이터의 특성에 따라 Channel에서 다수의 Sink 컴포넌트로 라우팅이 필요할 때 구성, 한 개의 플럼 에이전트 안에서 두 개 이상의 Source-Channel-Sink 컴포넌트 구성 및 관리도 가능
     - 플럼 에이전트
       - Source - Interceptor - Channel - Sink1 / Sink 2
       - Source - Channel - Sink
  3. 플럼 에이전트에서 수집한 데이터를 플럼 에이전트 2, 3 에 전송할 때 로드 밸런싱, 복제, 페일오버(Failover)등의 기능을 선택적으로 수행할 수 있음. 수집해야 할 원천 시스템은 한 곳이지만 높은 성능과 안정성이 필요할 때 주로 사용되는 아키텍처
     - 플럼 에이전트 1
       - Source - Channel - Sink
       - 플럼 에이전트 2
         - Source - Channel - Sink
       - 플럼 에이전트 3
         - Source - Channel - Sink
  4. 수집 해야할 원천 시스템이 다양하고 대규모의 데이터가 유입될 때 사용하는 플럼의 분산 아키텍처, 플럼 에이전트 1,2,3,4에서 수집한 데이터를 플럼 에이전트 5에서 집계(Aggregation)하고, 이 때 플럼 에이전트 6으로 이중화해서 성능과 안정성을 보장하는 구성.
     - 플럼 에이전트 1
       - Source - Channel - Sink
       - 플럼 에이전트 5
         - Source - Interceptor - Channel - Sink1 / Sink 2
     - 플럼 에이전트 2
       - Source - Channel - Sink
     - 플럼 에이전트 3
       - 플럼 에이전트 6
         - Source - Interceptor - Channel - Sink1 / Sink 2
     - 플럼 에이전트 4
       - Source - Channel - Sink
     - 1,2,3,4가 각각 5,6을 향하는 구조
3. 플럼 활용 방안
   - 플럼은 스마트카에서 발생하는 로그를 직접 수집하는 역할 담당
   - 발생하는 로그 유형에 따라 두 가지 플럼 에이전트를 구성
     1. 100대의 스마트카에 대한 상태 정보 로그 파일이 로그 시뮬레이터를 통해 매일 생성, 상태 정보 파일을 플럼 에이전트가 일 단위로 수집, 하둡에 적재, 향후 대규모 배치 분석에 활용
     2. 스마트카 운전자 100명의 운행 정보를 실시간으로 기록하는 로그파일이 로그 시뮬레이터에 의해 생성, 발생과 동시에 플럼 에이전트가 수집해서 카프카에 전송
4. 카프카
   1. 카프카 소개
      - 카프카(Kafka)는 MOM(Message Oriented Middleware) 소프트웨어 중 하나로, 대규모로 발생하는 메시지성 데이터를 비동기 방식으로 중계하는 역할
      - 원천 시스템으로부터 대규모 트랜잭션 데이터가 발생했을 때 중간에 데이터를 버퍼링하면서 타깃 시스템에 안정적으로 전송해주는 중간 시스템 필요, 카프카가 그와 관련된 강력한 기능과 아키텍처 제공
      - 카프카의 기본 요소
        - 공식 홈페이지
          - http://kafka.apache.org
        - 주요 구성 요소
          - Broker 
            - 카프카의 서비스 인스턴스로서, 다수의 Broker를 클러스터로 구성하고 Topic이 생성되는 물리적 서버
          - Topic
            - Broker에서 데이터의 발행/소비 처리를 위한 저장소
          - Provider
            - Broker의 특정 Topic에 데이터를 전송(발행)하는 역할로서 애플리케이션에서 카프카 라이브러리를 이용해 구현
          - Consumer
            - Broker의 특정 Topic에서 데이터를 수신(소비)하는 역할로서 애플리케이션에서 카프카 라이브러리를 이용해 구현
        - 라이선스
          - Apache
        - 유사 프로젝트
          - ActiveMQ
          - RabbitMQ
          - HonnetQ 등