# 5. 빅데이터 적재 II - 실시간 로그/분석 적재
## 3. 실시간 적재 파일럿 실행 1단계- 실시간 적재 아키텍처
### 3. 실시간 적재 아키텍처
- 운전자 운행 로그 (4KB/1초)
- 플럼 에이전트 2
  - Exec-Tail Source
  - Memory Channel
  - Kafka Sink
- 카프카
  - Topic
- 스톰
  - 카프카 Spout
  - Bolt/에스퍼
  - 레디스 Bolt
  - HBase Bolt
- 레디스
  - 과속 운전자 정보
- HBase
  - 모든 운전자의 운행 정보

 - 3장에서는 플럼의 DriverCarInfo 에이전트에서 수집한 운전자 운행 정보를 카프카의 토픽에 실시간 전송
 - 5장에서는 스톰의 카프카- Spout을 이용해 카프카의 토픽에 저장되어 있는 운전자 운행 정보를 가져와 처리, 카프카-Bolt에서 이벤트 조건에 따라 레디스와 HBase에 각각 분리 적재
### 4. 스톰의 실시간 데이터 처리
- 스톰은 카프카로부터 수신받은 운행 정보 데이터를 분산 처리, 최종 목적지 저장소에 적재하는 역할을 수행
- 이 때 빠르게 유입되는 데이터로부터 의미있는 패턴을 발견하기 위해 에스퍼 엔진을 이용
  - 스톰의 Spout가 카프카의 토픽으로부터 운전자의 실시간 운행 정보를 수신받아 첫번째 볼트에 전송. 해당 Bolt에서는 모든 운행 정보를 HBase Bolt로 전송, 에스퍼의 EPL에서 정의한 조건에 따라 과속한 차량의 정보를 레디스 Bolt에 전송
### 5. HBase에 모든 운전자 운행 정보 적재
- HBase의 테이블에는 "차량번호+발생일시"를 로우키로 해서 8개의 칼럼(발생 일시, 차량 번호, 가속 페달, 브레이크 페달, 운전대 회전각, 방향지시등, 주행 속도, 주행 구역)의 구조로 모든 스마트카 우전자의 운행 정보가 적재
### 6. 레디스에 과속한 운전자 정보 적재
- 레디스에 적재될 때는 현재 날짜를 키로 해서 과속한 차량의 정보를 세트 데이터 구조로 적재. 적재 영속 시간은 5시간, 이후에 만료 처리되어 메모리에서 자동으로 삭제