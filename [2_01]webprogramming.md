## 웹 프로그래밍
### 웹 프로그래밍의 이해
#### 웹 프로그래미으의 이해
- HTTP(S) 프로토콜로 통신하는, 클라이언트와 서버를 개발
- 웹 클라이언트와 웹 서버를 같이 개발 및 웹 클라이언트 또는 웹 서버 하나만 개발
- 웹 서버를 개발하는 경우가 많아서 파이썬 웹 프로그래밍이라고 하면 우선적으로 쟝고(django)같은 웹 프레임워크를 사용하여 웹 서버를 개발
  - HTML
  - DB(DB 모델링)
  - App platform
-  HTTP(S) 프로토콜로 통신하는, 클라이언트와 서버를 개발

### 다양한 웹 클라이언트
#### 웹 브라우저를 사용하여 요청
- 브라우저는 주소창에 입력된 문장을 해석하여 웹 서버에게 HTTP 요청을
보내는 웹 클라이언트의 역할을 수행

#### 리눅스 Curl 명령을 사용하여 요청
- 리눅스 curl 명령은 HTTP/HTTPS/FTP 등 여러 가지의 프로토콜을 사용
하여 데이터를 송수신할 수 있는 명령
#### Telnet을 사용하여 요청
- 리눅스의 telnet 프로그램을 사용하여 HTTP 요청을 보낼 수도 있음
- telnet 명령은 터미널 창에서 입력하는 내용을 그대로 웹 서버에 전송
- telnet 프로그램이 웹 클라이언트의 역할을 수행
- 응답 메시지를 수신한 후, telnet 프로그램을 종료하기위해 마지막 두 라인을 입력
#### 직접 만든 클라이언트로 요청
- 직접 만든 클라이언트 요청에 대한 웹 서버의 응답
- 웹 클라이언트의 형태는 달라도 동일한 요청에 대해서 동일한 응답을 받는 것을 확인

### HTTP 프로토콜
#### HTTP 메시지의 구조
- 스타트라인은 요청 메시지일 때 요청라인request line이라고 하고, 응답 메시지일 ,때 상태라인status line이라고 함
- <table><tr><td>스타트 라인(Start Line) </td><td>요청 라인 또는 상태 라인</td></tr><tr><td>헤더(Header)</td><td>헤더는 생략 가능</td></tr><tr><td>빈 줄(Blank Line)</td><td>헤더의 끝을 빈 줄로 식별</td></tr><tr><td>바디(Body)</td><td>바디는 생략 가능</td></tr></table>
- 요청라인으로, 요청 방식method, 요청 URL, 프로토콜 버전으로 구성
```http 
GET /book/shakespeare HTTP/1.1
Host:www.example.com:8080
```
#### HTTP 처리 방식
- HTTP 메소드 종류
- GET 방식은 지정한 URL의 정보를 가져오는 메소드로, 가장 많이 사용
- POST의 대표적인 기능은 리소스를 생성하는 것으로, 블로그에 글을 등록하는 경우가 이에 해당
- PUT은 리소스를 변경하는 데 사용
<table>
    <tr>
        <th>메소드명</th><th>의미</th><th>CRUD와 매핑되는 역할</th>
    </tr>
    <tr>
        <td>GET</td><td>리소스 취득</td><td>Read(조회)</td>
    </tr>
    <tr>
        <td>POST</td><td>리소스 생성, 리소스 데이터 추가</td><td>Create(생성)</td>
    </tr>
    <tr>
        <td>PUT</td><td>리소스 변경</td><td>Update(변경)</td>
    </tr>
    <tr>
        <td>DELETE</td><td>리소스 삭제</td><td>Delete(삭제)</td>
    </tr>
    <tr>
        <td>HEAD</td><td>리소스의 헤더(메타데이터) 취득</td>
    </tr>
    <tr>
        <td>OPTIONS</td><td>리소스가 서포트하는 메소드 취득</td>
    </tr>
    <tr>
        <td>TRACE</td><td>루프백 시험에 사용</td>
    </tr>
    <tr>
        <td>CONNECT</td><td>프독시 동작의 터널 접속으로 변경</td>
    </tr>
</table>

#### GET과 POST 메소드
- 현실적으로 가장 많이 사용하는 메소드는 GET과 POST 2가지
```http
GET http://docs.djangoproject.com/search/?q=forms&release=1 HTTP/1.1
```
```http
POST http://docs.djangoproject.com/search/ HTTP/1.1
Content-Type: application/x-www-form-urlencoded

q=forms&release=1
```
- 파이썬의 장고 프레임워크에서도 폼의 데이터는 POST 방식만을 사용하
고 있음

#### 상태코드
- 서버에서의 처리 결과는 응답 메시지의 상태라인에 있는 상태 코드(Statuscode)를 보고 파악할 수 있음
-<table>
    <tr>
        <th> 메소드명</th><th>의미</th><th>CRUD와 매칭되는 역할</th>
    </tr>
    <tr>
        <td> 1xx</td><td>Informational(정보 제공)</td><td>일시적인 응답으로, 현재 클라이언트의 요청까지 처리되었으니 계속 진행하라는 의미, HTTP 1.1 버전부터 추가</td>
    </tr>
    <tr>
        <td>2xx</td><td>Success(성공)</td><td>클라이언트의 요청이 서버에서 성공적으로 처리되었다는 의미</td>
    </tr>
    <tr>
        <td>3xx</td><td>Redirection(리다이렉션)</td><td>완전한 처리를 위해서 추가적인 동작을 필요로 하는 경우. 주로 서버의 주소 또는 요청한 URL의 웹 문서가 이동되었으니, 그 주소로 다시 시도해보라는 의미</td>
    </tr>
    <tr>
        <td>4xx</td><td>Client Error(클라이언트 에러)</td><td>없는 페이지를 요청하는 것처럼 클라이언트의 요청 메시지 내용이 잘못된 경우</td>
    </tr>
    <tr>
        <td>5xx</td><td>Server Error(서버 에러)</td><td>서버 측 사정에 의해서 메시지 처리에 문제가 발생한 경우, 서버의 부하, DB 처리 과정 오류, 서버에서 익셉션이 발생하는 경우 해당</td>
    </tr>
</table>

### URL 설계
#### URL 구성 항목
- URL 구성 항목
`http://www.example.com:80/services?category=2&kind=patents#n10`
`URL 스킴/호스트명/포트번호/경로/쿼리스트링/프래그먼트`

- URL 스킴 : URL에 사용된 프로토콜을 의미.
- 호스트명 : 웹 서버의 호스트명으로, 도메인명 또는 IP 주소로 표현.
- 포트번호 : 웹 서버 내의 서비스 포트번호. 생략 시에는 디폴트 포트번호로, http는 80을,
https는 443을 사용
- 경로 : 파일이나 애플리케이션 경로를 의미
- 쿼리스트링 : 질의 문자열로, 앰퍼샌드(&)로 구분된 이름=값 쌍 형식으로 표현
- 프라그먼트 : 문서 내의 앵커 등 조각을 지정

- URL은 웹 클라이언트에서 호출한다는 시점에서 보면 웹 서버에 존재하는 애플리케이션에 대한 API(Application Programming Interface)라고 할 수 있음
- URL을 바라보는 또 한 가지 측면은 REST 방식으로 URL을 설계하는 것. REST 방식이란 웹 서버에 존재하는 요소들을 모두 리소스라고 정의하고,URL을 통해 웹 서버의 특정 리소스를 표현한다는 개념

- 간편 URL은 쿼리스트링 없이 경로만 가진 간단한 구조의 URL을 말함.
- 검색 엔진 의 처리를 최적화하기 위해 생겨난 간편한 URL은 URL을 입력하거나 기억하기 쉽다는 부수적인 장점도 있어, 검색 엔진 친화적
- URLsearch engine friendly url 또는 사용자 친화적 URLuser friendly url이라고 부르기도 함

#### 파이썬의 URL
- URL을 정의하기 위해 정규표현식Regular Expression을 추가적으로 사용할 수 있음. 

## 웹 애플리케이션 서버
### 웹 애플리케이션 서버
- 웹 서버 및 웹 애플리케이션 서버라는 용어는 SW 측면의 서버 프로그램을 의미
- 웹 서버 프로그램(웹 서비스 구현)
  - HTML 구현
  - function(기능)구현
  - DB설계 및 연동(CRUD)구현
    - DB모델링 table(필드,정의....)
    - CRUD(Select,Update,Insert,Delete)
    - 계정 생성/권한 부여(장애/보안)
<table>
    <tr>
        <th>구분</th><th>역할</th><th>프로그램 명</th>
    </tr>
    <tr>
        <td>웹 서버</td><td>웹 클라이언트의 요청을 받아서 요청을 처리하고, 그 결과를 웹 클라이언트에게 응답. 주로 정적 페이지인 HTML,이미지,CSS,자바스크립트 파일을 웹 클라이언트에 제공할 때 웹 서버를 사용, 만약 동적 페이지 처리가 필요할 때 웹 애플리케이션 서버에 처리 넘김</td><td>Apache httpd,Nginx,lightpd,IIS등</td>
    </tr>
    <tr>
        <td>웹 애플리케이션 서버</td><td>웹 서버로부터 동적 페이지 요청을 받아 요청을 처리하고 그 결과를 웹 서버로 반환
        주로 동적 페이지 생성을 위한 프로그램 실행과 데이터 베이스 연동 기능을 처리</td><td>Apache Tomcat,JBoss,WebLogic,WebSphere,Jetty,Jeus,mod_wsgi,uWSGI,Gunicorn 등</td>
    </tr>
</table>

- 기술의 발전에 따른 웹 서버 기술의 변화
<table>
    <tr>
        <th>웹 서버 등장</th><th>CGI 프로그램 등장</th><th>CGI 대안 기술 2가지</th><th>웹 애플리케이션 서버 등장</th>
    </tr>
    <tr>
        <td>웹 서버</td><td>웹서버 <-> CGI 프로그램</td><td>웹 서버(스크립트 엔진)<br>웹 서버 <->데몬 프로그램 </td><td>웹 서버<-> 웹 애플리케이션 서버</td>
    </tr>
</table>

#### 정적 페이지 vs 동적 페이지
- 정적static, 동적dynamic이란 용어는 사용자가 페이지를 요청하는 시점에 페이지의 내용이 유지되는가 또는 변경되는가를 구분해주는 용어.
- 동적 페이지에는 프로그래밍 코드가 포함되어 있어서 페이지 요청 시점에 HTML 문장을 만들어내는 것

#### 전통적인 CGI 방식의 요청 처리
- CGI 방식의 근본적인 문제점은 각각의 클라이언트 요청에 대하여 독립적인 별도의 프로세스가 생성
- 요청이 많아질수록 프로세스가 많아지고, 프로세스가 많아질수록 비례적으로 프로세스가 점유하는 메모리 요구량도 커져서 시스템에 많은 부하를 주는 요인

- 웹 클라이언트 -> 요청 ->웹 서버 ->(독립적인 프로세스로 실행) ->C,Perl,PHP 프로그램  
- 웹 클라이언트 <- 응답 <-웹 서버

#### CGI 방식의 대안 기술
- CGI 방식의 대안 기술 중 하나는 별도의 애플리케이션(CGI 프로그램과 같은 역할을 하는 프로그램)을 Perl, PHP 등의 스크립트 언어로 작성하고, 스크립트를 처리하는 스크립트 엔진(인터프리터)을 웹 서버에 내장시켜서 CGI 방식의 단점이었던 별도의 프로세스를 기동시키는 오버헤드를 줄이는 방식

#### 애플리케이션 서버 방식
- 웹 서버와 웹 애플리케이션 서버가 분리됨에 따라, 서로의 역할도 구분하
여 사용하는 것이 좋음.
- 정적 페이지를 처리하는 경우에 비해서 동적 페이지를 처리하는 경우가 수 배에서 수십 배의 메모리를 소비하기 때문.

- 웹 클라이언트 ->요청-> 웹 서버 >처리 위임> 웹 애플리케이션 서버 -웹 애플리케이션 서버에서 실행 -> 애플리케이션
- 웹 클라이언트 <-요청 <- 웹 서버 < 결과 반환 <웹 애플리케이션 서버

#### 애플리케이션 서버 방식
- 애플리케이션 서버 방식에서의 서버 간 구성도.
- 웹 클라이언트 ->요청-> 웹 서버 >처리 위임> 웹 애플리케이션 서버 -웹 애플리케이션 서버에서 실행 -> 애플리케이션<-DB 연동 ->데이터베이스 서버
- 웹 클라이언트 <-요청 <- 웹 서버 < 결과 반환 <웹 애플리케이션 서버
#### 웹 서버와의 역할 구분
- 서버와 애플리케이션 서버의 역할과 HW 배치
- 애플리케이션 서버 방식에서 웹 서버와 웹 애플리케이션 서버를 동일한 HW 박스에 배치할 수도 있고, 다른 HW 박스에 배치할 수도 있다.
- 웹 서버와 웹 애플리케이션 서버 프로그램이 함께 필요하며, 이 두 개의 서버를 동일한 HW 박스에서 기동시키는 것도 충분히 가능한 구성.
- 서비스 운용 관리 측면에서 하나의 HW박스에 구성하는 것이 좀 더 간편한 방식이기 때문

### 웹 라이브러리 구성
#### 웹 라이브러리 구성
- urllib 패키지에는 웹 클라이언트를 작성하는 데 사용되는 모듈들이 있으며, 가장 빈번하게 사용하는 모듈
- http 패키지는 크게 서버용과 클라이언트용 라이브러리로 나누어 모듈을 담고 있음
- 쿠키 관련 라이브러리도 http 패키지 내에서 서버용과 클라이언트용으로 모듈이 구분

