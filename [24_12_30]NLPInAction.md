# 1.NLP 기초.
## 4. 단어 빈도에서 의미 찾기: 의미 분석
### 7. 피드백에 기초한 방향 조정
#### 1.선형 판별 분석(LDA)
- 분류명 붙은 문자 메시지들로 선형 판별 분석 모형을 훈련
- LDA는 LSA와 비슷하되, 고차원 공간에서 차원들(BOW나 TF-IDF벡터의 단어들)의 최고의 일차결합을 찾아내려면 분류명이나 기타 점수들이 미리 부여된 훈련 자료가 필요. LSA는 새 벡터 공간에서 모든 벡터가 서로 최대한 떨어지게(즉,분산이 최대가 되게)만드는 반면, LDA는 부류들 사이의 거리, 즉 한 부류에 속하는 벡터들의 무게중심과 다른 부류에 속하는 벡터들의 무게중심 사이의 거리를 최대화.
- LDA를 수행하려면 LDA 알고리즘에게 분류명 붙은 견본들을 제공, 우리가 모형화하고자 하는 '주제'들이 무엇인지 알려주어야 함. 그래야 알고리즘이 고차원 공간을 저차원 공간으로 변환하는 최적의 행렬을 계산할 수 있음. 그리고 그 결과로 얻은 저차원 벡터의 차원은 우리가 제공할 수 있는 서로 다른 분류명 또는 점수보다 많을 수 없음. 지금 예에서는 하나의 '스팸성'주제만 있으면 되므로, LDA는 1차원 벡터를 산출. 다음은 이러한 1차원 주제모형이 스팸 문자 메시지들을 얼마나 잘 판별하는지 시험해보는 코드.
- ```python
  lda =LDA(n_components=1)
  lda=lda.fit(tfidf_docs,sms.spam)
  sms['lda_spaminess']=lda.predict(tfidf_docs)
  ((sms.spam-sms.lda_spaminess)**2.).sum()**.5
  (sms.spam==sms.lda_Spaminess).sum()
  len(sms)
  ```
- 오차가 0.0이라는 것은 이 모형이 자료 집합의 모든 스팸 메시지를 정확히 골라냈음을 의미.