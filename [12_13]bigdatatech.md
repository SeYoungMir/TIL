# 6. 빅데이터 탐색
## 2. 빅데이터 탐색에 활용되는 기술
### 1. 하이브
- 하이브 아키텍처
  - 하이브의 아키텍처에서 가장 큰 특징은 하이브 클라이언트에서 작성한 QL(Query Language)이 맵리듀스 프로그램으로 변환되어 실행된다는 것
  - CLI,웹 콘솔 등을 통해 하이브 QL을 작성하면 쿼리 엔진(Query Engine)에 있는 SQL 파서가 하이브 QL을 맵 리듀스 프로그램으로 변환, 이 맵 리듀스 프로그램이 하둡 클러스터에 전송되어 여러 데이터 노드에서 분산 실행됨
  - 위 과정에서 하이브의 MetaStore가 매우 중요한 역할을 함. 하이브 DW에서 정의한 데이터베이스, 테이블, 파티션 정보 등이 모두 MetaStore에서 저장 및 관리되기 때문
  - 하이브 QL이 작동하면 항상 MetaStore를 참고해 하이브의 런타임 환경이 만들어짐. 또한 하이브는 쓰리프트API를 제공하는데 클라이언트 프로그램이 API를 호출해 다양한 하이브 액션(Action)을 외부에서도 ㅎ실행 할 수 있게 함
  - 하이브 아키텍처
    - HDFS
    - 맵/리듀스
    - 하이브
      - CLI/웹 콘솔
      - JDBC/ODBC
      - Thrift API
      - Query Engine
      - MetaStore
- 하이브 활용 방안
  - 파일럿 프로젝트에서는 하이브를 이용해 스마트카 데이터셋을 다양한 각도로 탐색 및 가공 
  - 하이브 QL로 스마트카 데이터에 대한 조회, 결합, 분리, 변환, 정제 등의 작업을 수행해 스마트카 DW를 구성, 다시 DW에서 2,3차 탐색과 고급 분석을 진행, 스마트카 분석 마트를 만듦
  - 4장에서 수집한 데이터가 하이브의 External(빅데이터 레이크) 영역에 적재, 이를 정제해서 Managed(빅데이터 웨어하우스) 영역으로 옮기고 주제 영역 별 Mart를 구성하기 위해 하이브가 주로 사용
  - 하이브 활용 방안
    - External 영역
      - 스마트카 상태 데이터
      - 스마트카 마스터 데이터
      - 차량 용품 구매이력 데이터
    - HBase
      - 운전자 운행 데이터
    - 하이브 QL
    - Managed 영역
      - 스마트카 상태 데이터
      - 운전자 운행 데이터
      - 스마트카 마스터 데이터
      - 차량용품 구매이력 데이터
    - 하이브 QL
      - Mart 영역
        - 분석주제 1,2...
    - 빅데이터 기반 스마트카 데이터 웨어하우스 구축
    - 스마트카 및 운행 데이터에 대한 Cleansing,Filtering,Transformation 작업
  - 하이브 External과 Managed
    - 하이브의 데이터 아키텍처는 External 영역과 Managed 영역으로 구분
    - 데이터 제어와 관리에서 두 영역에 차이가 있음. 스키마에 디펜던시가 작은 영역이 External 영역, 그 반대가 Managed 영역
    - 비정형의 3V 데이터가 쌓이는 빅데이터 레이크 영역을 External에, 여기서 정형화된 빅데이터 웨어하우스나 마트 영역은 Managed 영역에 만듦(참고로 마트 영역은 성능과 연동 등을 고려해 하이브가 아닌 별도의 RDBMS에 구성하기도 함)
  - 피그
    - 하둡 에코시스템 가운데 하이브와 유사한 목적으로 맵리듀스의 복잡성을 해결하기 위한 피그(Pig)라는 프로젝트가 있음
    - 피그는 SQL 대시 피그 라틴(Pig Latin)이라는 언어를 제공, 하이브보다는 절차적인 요소가 많이 사용되는 특징
    - 하이브가 테이블을 기반으로 한 데이터 가공, 적재, 탐색 등에 최적화되었다면 피그는 HDFS 파일에 직접 접근해 다양한 데이터 처리 함수와 제어문으로 복잡한 데이터 파이프라인을 처리하는 데 적합함
